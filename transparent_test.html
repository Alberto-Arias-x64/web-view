<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebView Test</title>
    <style>
        :root {
            --color-primary: #5B8DF6;
            --color-primary-hover: #4A7DE5;
            --color-white: #FFFFFF;
            --color-black: #000000;
            --color-text-primary: #FFFFFF;
            --color-text-secondary: rgba(255, 255, 255, 0.85);
            --color-background-card: rgba(96, 96, 96, 0.75);
            --color-background-item-card: #FFFFFF;
            --color-text-dark: #000000;
            --color-text-gray: #666666;
            --color-discount: #00A650;
            --color-badge-bg: rgba(80, 80, 80, 0.7);
            --color-purple: #8B5CF6;
            --color-yellow: #FCD34D;
            --color-yellow-dark: #F59E0B;
            --spacing-xs: 4px;
            --spacing-sm: 6px;
            --spacing-md: 10px;
            --spacing-lg: 12px;
            --spacing-xl: 20px;
            --spacing-xxl: 28px;
            --border-radius-full: 50%;
            --border-radius-pill: 20px;
            --border-radius-card: 40px;
            --border-radius-item-card: 12px;
            --border-radius-badge: 6px;
            --size-icon-sm: 16px;
            --size-icon-md: 18px;
            --size-icon-lg: 24px;
            --size-logo: 40px;
            --font-size-sm: 10px;
            --font-size-md: 12px;
            --font-size-base: 13px;
            --font-size-lg: 14px;
            --font-size-xl: 18px;
            --font-size-xxl: 20px;
            --font-weight-normal: 400;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            background: transparent !important;
            background-color: transparent !important;
            min-height: 100vh;
            min-width: 100%;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            overflow: hidden;
        }

        main {
            position: relative;
            width: 100%;
            height: 100vh;
            padding: 20px;
        }

        .layout-top {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 16px;
        }

        .layout-bottom-left {
            position: absolute;
            top: 120px;
            left: 20px;
        }

        .layout-right {
            position: absolute;
            right: 20px;
            top: 120px;
        }

        .brand-follow-card {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--color-background-card);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 8px var(--spacing-md);
            border-radius: var(--border-radius-card);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            width: fit-content;
        }

        .brand-follow-card__left {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            flex: 1;
        }

        .brand-follow-card__logo {
            width: var(--size-logo);
            height: var(--size-logo);
            border-radius: var(--border-radius-full);
            background-color: var(--color-white);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            flex-shrink: 0;
        }

        .brand-follow-card__logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .brand-follow-card__info {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
            min-width: 0;
        }

        .brand-follow-card__name {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--color-text-primary);
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
        }

        .brand-follow-card__verified {
            width: var(--size-icon-sm);
            height: var(--size-icon-sm);
            background-color: var(--color-primary);
            border-radius: var(--border-radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .brand-follow-card__verified::after {
            content: '‚úì';
            color: var(--color-white);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
        }

        .brand-follow-card__followers {
            color: var(--color-text-secondary);
            font-size: var(--font-size-md);
            font-weight: var(--font-weight-normal);
        }

        .brand-follow-card__button {
            background-color: var(--color-primary);
            color: var(--color-white);
            border: none;
            padding: 8px var(--spacing-xl);
            border-radius: var(--border-radius-pill);
            font-size: var(--font-size-md);
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            transition: all 0.2s ease;
            flex-shrink: 0;
            min-width: 100px;
            justify-content: center;
        }

        .brand-follow-card__button:hover {
            background-color: var(--color-primary-hover);
        }

        .brand-follow-card__button:active {
            transform: scale(0.98);
        }

        .brand-follow-card__button-icon {
            font-size: var(--size-icon-lg);
            line-height: 1;
            font-weight: var(--font-weight-normal);
        }

        .item-card {
            background-color: var(--color-background-item-card);
            border-radius: var(--border-radius-item-card);
            overflow: hidden;
            width: 180px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
        }

        .item-card__image-container {
            position: relative;
            width: 100%;
            aspect-ratio: 1;
            background-color: #F5F5F5;
            overflow: hidden;
        }

        .item-card__badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background-color: var(--color-badge-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--color-white);
            padding: 6px 10px;
            border-radius: var(--border-radius-badge);
            font-size: var(--font-size-md);
            font-weight: var(--font-weight-semibold);
        }

        .item-card__image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .item-card__content {
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .item-card__price-container {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .item-card__original-price {
            color: var(--color-text-gray);
            font-size: var(--font-size-sm);
            text-decoration: line-through;
            font-weight: var(--font-weight-normal);
            line-height: 1.4;
        }

        .item-card__current-price-row {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            flex-wrap: nowrap;
        }

        .item-card__current-price {
            color: var(--color-text-dark);
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            line-height: 1.3;
            white-space: nowrap;
        }

        .item-card__discount {
            color: var(--color-discount);
            background-color: rgba(0, 166, 80, 0.1);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
            padding: 2px 6px;
            border-radius: 4px;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .item-card__cta-button {
            width: 100%;
            background-color: var(--color-primary);
            color: var(--color-white);
            border: none;
            padding: 10px;
            border-radius: var(--border-radius-badge);
            font-size: var(--font-size-md);
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .item-card__cta-button:hover {
            background-color: var(--color-primary-hover);
        }

        .item-card__cta-button:active {
            transform: scale(0.98);
        }

        .explore-button {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            background-color: var(--color-badge-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            color: var(--color-white);
            padding: var(--spacing-xs);
            border-radius: var(--border-radius-badge) 0 0 var(--border-radius-badge);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-semibold);
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: -20px;
        }

        .explore-button:hover {
            background-color: rgba(80, 80, 80, 0.85);
        }

        .explore-button:active {
            transform: scale(0.98);
        }

        .explore-button__icon {
            width: 28px;
            height: 28px;
            background-color: var(--color-primary);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .explore-button__icon svg {
            width: 18px;
            height: 18px;
        }

        .explore-button__arrow {
            font-size: var(--font-size-lg);
            line-height: 1;
        }

        .reward-badge {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
        }

        .reward-badge__icon-container {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #FCD34D 0%, #F59E0B 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            border: 3px solid #FCD34D;
        }

        .reward-badge__icon-inner {
            width: 42px;
            height: 42px;
            background: linear-gradient(135deg, #A855F7 0%, #7C3AED 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .reward-badge__star {
            width: 24px;
            height: 24px;
            color: var(--color-white);
        }

        .reward-badge__points {
            background: linear-gradient(135deg, #FCD34D 0%, #F59E0B 100%);
            color: var(--color-text-dark);
            padding: 6px 16px;
            border-radius: 16px;
            font-size: var(--font-size-md);
            font-weight: var(--font-weight-bold);
            margin-top: -10px;
            z-index: 1;
            border: 2px solid #F59E0B;
        }

        .debug-panel {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 16px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 9999;
            max-width: 90%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .debug-panel__title {
            color: #00FF00;
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 8px;
            font-family: monospace;
        }

        .debug-panel__row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .debug-panel__button {
            background-color: #2563EB;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: system-ui;
        }

        .debug-panel__button:hover {
            background-color: #3B82F6;
            transform: scale(1.05);
        }

        .debug-panel__button:active {
            transform: scale(0.95);
        }

        .debug-panel__button--hide {
            background-color: #DC2626;
        }

        .debug-panel__button--hide:hover {
            background-color: #EF4444;
        }

        .debug-panel__button--update {
            background-color: #059669;
        }

        .debug-panel__button--update:hover {
            background-color: #10B981;
        }

        .debug-panel__button--toggle {
            background-color: #7C3AED;
        }

        .debug-panel__button--toggle:hover {
            background-color: #8B5CF6;
        }

        .debug-panel__separator {
            height: 1px;
            background-color: rgba(255, 255, 255, 0.2);
            margin: 4px 0;
        }

        @keyframes slideInFromLeft {
            from {
                opacity: 0;
                transform: translateX(-100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutToLeft {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(-100%);
            }
        }

        @keyframes slideOutToRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        .component-visible {
            animation-duration: 0.5s;
            animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            animation-fill-mode: both;
        }

        .component-hidden {
            animation-duration: 0.4s;
            animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            animation-fill-mode: both;
        }

        .brand-follow-card.component-visible {
            animation-name: slideInFromLeft;
        }

        .brand-follow-card.component-hidden {
            animation-name: slideOutToLeft;
        }

        .item-card.component-visible {
            animation-name: slideInFromLeft;
        }

        .item-card.component-hidden {
            animation-name: slideOutToLeft;
        }

        .reward-badge.component-visible {
            animation-name: slideInFromRight;
        }

        .reward-badge.component-hidden {
            animation-name: slideOutToRight;
        }
    </style>
</head>
<body>
    <main>
        <!-- Layout Top: Brand Follow Card + Explore Button -->
        <div class="layout-top">
            <div class="brand-follow-card">
                <div class="brand-follow-card__left">
                    <div class="brand-follow-card__logo">
                        <svg viewBox="0 0 100 100" width="36" height="36">
                            <path d="M50,20 L30,35 L45,35 L25,50 L45,50 L25,70 L50,50 L35,50 L55,35 L40,35 Z" fill="black"/>
                            <path d="M50,20 L70,35 L55,35 L75,50 L55,50 L75,70 L50,50 L65,50 L45,35 L60,35 Z" fill="black"/>
                        </svg>
                    </div>
                    <div class="brand-follow-card__info">
                        <div class="brand-follow-card__name">
                            Adidas
                            <span class="brand-follow-card__verified"></span>
                        </div>
                        <div class="brand-follow-card__followers">+12 mil seguidores</div>
                    </div>
                </div>
                <button class="brand-follow-card__button">
                    <span class="brand-follow-card__button-icon">+</span>
                    Seguir
                </button>
            </div>
        </div>

        <!-- Explore Button (Always Visible) -->
        <div class="layout-right" style="top: 20px;">
            <button class="explore-button">
                <div class="explore-button__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 22V12H15V22" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <span>Explorar</span>
                <span class="explore-button__arrow">‚Ä∫</span>
            </button>
        </div>

        <!-- Layout Bottom Left: Item Card -->
        <div class="layout-bottom-left">
            <div class="item-card">
                <div class="item-card__image-container">
                    <span class="item-card__badge">3</span>
                    <img 
                        class="item-card__image" 
                        src="https://almacendelingeniero.com/wp-content/uploads/2023/03/Royal-Lo-Cut-Croydon-521-59-7-Negro.png"
                        alt="Product"
                    />
                </div>
                <div class="item-card__content">
                    <div class="item-card__price-container">
                        <div class="item-card__original-price">$ 111.000</div>
                        <div class="item-card__current-price-row">
                            <span class="item-card__current-price">$ 880.000</span>
                            <span class="item-card__discount">10% OFF</span>
                        </div>
                    </div>
                    <button class="item-card__cta-button">Comprar ahora</button>
                </div>
            </div>
        </div>

        <!-- Layout Right: Reward Badge -->
        <div class="layout-right" style="top: 120px;">
            <div class="reward-badge">
                <div class="reward-badge__icon-container">
                    <div class="reward-badge__icon-inner">
                        <svg class="reward-badge__star" viewBox="0 0 24 24" fill="white" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                        </svg>
                    </div>
                </div>
                <div class="reward-badge__points">+ 20</div>
            </div>
        </div>

        <!-- DEBUG BUTTONS-->
        <!--<div class="debug-panel" style="display: none;">
            <div class="debug-panel__title">üêõ DEBUG PANEL</div>
            
            <div class="debug-panel__row">
                <button class="debug-panel__button" onclick="debugShowBrandCard()">Show Brand Card (10s)</button>
                <button class="debug-panel__button debug-panel__button--hide" onclick="debugHideBrandCard()">Hide Brand</button>
            </div>
            
            <div class="debug-panel__row">
                <button class="debug-panel__button" onclick="debugShowItemCard()">Show Item Card (10s)</button>
                <button class="debug-panel__button debug-panel__button--hide" onclick="debugHideItemCard()">Hide Item</button>
            </div>
            
            <div class="debug-panel__row">
                <button class="debug-panel__button" onclick="debugShowReward()">Show Reward (10s)</button>
                <button class="debug-panel__button debug-panel__button--hide" onclick="debugHideReward()">Hide Reward</button>
            </div>
            
            <div class="debug-panel__separator"></div>
            
            <div class="debug-panel__row">
                <button class="debug-panel__button debug-panel__button--update" onclick="debugUpdateBrand()">Update Brand (Nike)</button>
                <button class="debug-panel__button debug-panel__button--update" onclick="debugUpdateItem()">Update Item (Sale!)</button>
            </div>
            
            <div class="debug-panel__row">
                <button class="debug-panel__button debug-panel__button--update" onclick="debugUpdateReward()">Update Reward (+50)</button>
                <button class="debug-panel__button debug-panel__button--toggle" onclick="debugTogglePanel()">Hide Debug Panel</button>
            </div>
        </div>-->
    </main>

    <script>
        /**
         * @typedef {Object} BrandFollowCardData
         * @property {string} brandName - Brand name to display
         * @property {string} followers - Followers count text
         * @property {string} logoUrl - URL of the brand logo
         * @property {boolean} isVerified - Whether the brand is verified
         */

        /**
         * @typedef {Object} ItemCardData
         * @property {string} badge - Badge text (e.g., "3")
         * @property {string} imageUrl - Product image URL
         * @property {string} originalPrice - Original price text
         * @property {string} currentPrice - Current price text
         * @property {string} discount - Discount text (e.g., "10% OFF")
         * @property {string} ctaText - Call to action button text
         */

        /**
         * @typedef {Object} RewardBadgeData
         * @property {string} points - Points text (e.g., "+ 20")
         */

        /**
         * @typedef {Object} ComponentVisibilityData
         * @property {string} component - Component name: 'brandFollowCard' | 'itemCard' | 'exploreButton' | 'rewardBadge'
         * @property {number} duration - Duration in milliseconds to show the component (0 = infinite)
         * @property {Object} [data] - Optional data to configure the component
         */

        /**
         * @typedef {Object} PostMessageEvent
         * @property {string} type - Event type
         * @property {*} [data] - Event data
         */

        /**
         * Event Bus for WebView communication using postMessage
         * 
         * @description
         * This bus handles bidirectional communication between the WebView and native Android code.
         * 
         * ## Incoming Events (from Native to WebView):
         * 
         * 1. **showComponent** - Shows a component with optional duration
         *    ```javascript
         *    {
         *      type: 'showComponent',
         *      data: {
         *        component: 'brandFollowCard',
         *        duration: 5000,
         *        data: { brandName: 'Adidas', followers: '+12 mil seguidores' }
         *      }
         *    }
         *    ```
         * 
         * 2. **hideComponent** - Hides a component immediately
         *    ```javascript
         *    {
         *      type: 'hideComponent',
         *      data: { component: 'brandFollowCard' }
         *    }
         *    ```
         * 
         * 3. **updateComponentData** - Updates component data without showing/hiding
         *    ```javascript
         *    {
         *      type: 'updateComponentData',
         *      data: {
         *        component: 'itemCard',
         *        data: { currentPrice: '$ 750.000', discount: '15% OFF' }
         *      }
         *    }
         *    ```
         * 
         * ## Outgoing Events (from WebView to Native):
         * 
         * 1. **followButtonClicked** - Emitted when follow button is clicked
         *    ```javascript
         *    { type: 'followButtonClicked', data: { brandName: 'Adidas' } }
         *    ```
         * 
         * 2. **buyNowButtonClicked** - Emitted when buy now button is clicked
         *    ```javascript
         *    { type: 'buyNowButtonClicked', data: { productId: '3' } }
         *    ```
         * 
         * 3. **exploreButtonClicked** - Emitted when explore button is clicked
         *    ```javascript
         *    { type: 'exploreButtonClicked', data: {} }
         *    ```
         * 
         * 4. **rewardBadgeClicked** - Emitted when reward badge is clicked
         *    ```javascript
         *    { type: 'rewardBadgeClicked', data: { points: '+ 20' } }
         *    ```
         * 
         * 5. **componentShown** - Emitted when a component is shown
         *    ```javascript
         *    { type: 'componentShown', data: { component: 'brandFollowCard' } }
         *    ```
         * 
         * 6. **componentHidden** - Emitted when a component is hidden
         *    ```javascript
         *    { type: 'componentHidden', data: { component: 'brandFollowCard' } }
         *    ```
         */
        const EventBus = {
            timers: {},
            
            /**
             * Sends a message to the native Android WebView
             * @param {PostMessageEvent} event - Event object to send
             */
            sendToNative(event) {
                if (window.Android && window.Android.postMessage) {
                    window.Android.postMessage(JSON.stringify(event));
                } else {
                    window.parent.postMessage(event, '*');
                }
                console.log('[EventBus] Sent to native:', event);
            },

            /**
             * Shows a component with optional duration
             * @param {ComponentVisibilityData} config - Component configuration
             */
            showComponent(config) {
                const { component, duration = 0, data } = config;
                
                // Don't allow hiding/showing explore button as it's always visible
                if (component === 'exploreButton') {
                    console.warn('[EventBus] exploreButton is always visible and cannot be controlled');
                    return;
                }
                
                const element = this.getComponentElement(component);
                
                if (!element) {
                    console.error(`[EventBus] Component not found: ${component}`);
                    return;
                }

                if (data) {
                    this.updateComponentData(component, data);
                }

                element.style.display = '';
                element.classList.remove('component-hidden');
                element.classList.add('component-visible');

                this.sendToNative({
                    type: 'componentShown',
                    data: { component }
                });

                if (this.timers[component]) {
                    clearTimeout(this.timers[component]);
                }

                if (duration > 0) {
                    this.timers[component] = setTimeout(() => {
                        this.hideComponent(component);
                    }, duration);
                }
            },

            /**
             * Hides a component
             * @param {string} component - Component name
             */
            hideComponent(component) {
                // Don't allow hiding explore button as it's always visible
                if (component === 'exploreButton') {
                    console.warn('[EventBus] exploreButton is always visible and cannot be hidden');
                    return;
                }
                
                const element = this.getComponentElement(component);
                
                if (!element) {
                    console.error(`[EventBus] Component not found: ${component}`);
                    return;
                }

                element.classList.remove('component-visible');
                element.classList.add('component-hidden');

                setTimeout(() => {
                    element.style.display = 'none';
                    element.classList.remove('component-hidden');
                }, 400);

                this.sendToNative({
                    type: 'componentHidden',
                    data: { component }
                });

                if (this.timers[component]) {
                    clearTimeout(this.timers[component]);
                    delete this.timers[component];
                }
            },

            /**
             * Gets the DOM element for a component
             * @param {string} component - Component name
             * @returns {HTMLElement|null}
             */
            getComponentElement(component) {
                const elementMap = {
                    'brandFollowCard': document.querySelector('.brand-follow-card'),
                    'itemCard': document.querySelector('.item-card'),
                    'exploreButton': document.querySelector('.explore-button'),
                    'rewardBadge': document.querySelector('.reward-badge')
                };
                return elementMap[component] || null;
            },

            /**
             * Updates component data
             * @param {string} component - Component name
             * @param {Object} data - Data to update
             */
            updateComponentData(component, data) {
                switch(component) {
                    case 'brandFollowCard':
                        this.updateBrandFollowCard(data);
                        break;
                    case 'itemCard':
                        this.updateItemCard(data);
                        break;
                    case 'rewardBadge':
                        this.updateRewardBadge(data);
                        break;
                }
            },

            /**
             * Updates brand follow card data
             * @param {BrandFollowCardData} data
             */
            updateBrandFollowCard(data) {
                if (data.brandName) {
                    const nameElement = document.querySelector('.brand-follow-card__name');
                    if (nameElement) {
                        const textNode = nameElement.childNodes[0];
                        if (textNode) textNode.textContent = data.brandName + ' ';
                    }
                }
                if (data.followers) {
                    const followersElement = document.querySelector('.brand-follow-card__followers');
                    if (followersElement) followersElement.textContent = data.followers;
                }
                if (data.logoUrl) {
                    const logoElement = document.querySelector('.brand-follow-card__logo svg');
                    if (logoElement) {
                        logoElement.outerHTML = `<img src="${data.logoUrl}" alt="${data.brandName || 'Brand'}" style="width: 100%; height: 100%; object-fit: contain;">`;
                    }
                }
                if (typeof data.isVerified !== 'undefined') {
                    const verifiedElement = document.querySelector('.brand-follow-card__verified');
                    if (verifiedElement) {
                        verifiedElement.style.display = data.isVerified ? 'flex' : 'none';
                    }
                }
            },

            /**
             * Updates item card data
             * @param {ItemCardData} data
             */
            updateItemCard(data) {
                if (data.badge) {
                    const badgeElement = document.querySelector('.item-card__badge');
                    if (badgeElement) badgeElement.textContent = data.badge;
                }
                if (data.imageUrl) {
                    const imageElement = document.querySelector('.item-card__image');
                    if (imageElement) imageElement.src = data.imageUrl;
                }
                if (data.originalPrice) {
                    const originalPriceElement = document.querySelector('.item-card__original-price');
                    if (originalPriceElement) originalPriceElement.textContent = data.originalPrice;
                }
                if (data.currentPrice) {
                    const currentPriceElement = document.querySelector('.item-card__current-price');
                    if (currentPriceElement) currentPriceElement.textContent = data.currentPrice;
                }
                if (data.discount) {
                    const discountElement = document.querySelector('.item-card__discount');
                    if (discountElement) discountElement.textContent = data.discount;
                }
                if (data.ctaText) {
                    const ctaButton = document.querySelector('.item-card__cta-button');
                    if (ctaButton) ctaButton.textContent = data.ctaText;
                }
            },

            /**
             * Updates reward badge data
             * @param {RewardBadgeData} data
             */
            updateRewardBadge(data) {
                if (data.points) {
                    const pointsElement = document.querySelector('.reward-badge__points');
                    if (pointsElement) pointsElement.textContent = data.points;
                }
            }
        };

        // Listen for messages from native Android
        window.addEventListener('message', (event) => {
            console.log('[EventBus] Received message:', event.data);
            
            const message = typeof event.data === 'string' ? JSON.parse(event.data) : event.data;
            
            switch(message.type) {
                case 'showComponent':
                    EventBus.showComponent(message.data);
                    break;
                case 'hideComponent':
                    EventBus.hideComponent(message.data.component);
                    break;
                case 'updateComponentData':
                    EventBus.updateComponentData(message.data.component, message.data.data);
                    break;
            }
        });

        // Button click handlers
        document.querySelector('.brand-follow-card__button')?.addEventListener('click', () => {
            const brandName = document.querySelector('.brand-follow-card__name')?.childNodes[0]?.textContent?.trim() || '';
            EventBus.sendToNative({
                type: 'followButtonClicked',
                data: { brandName }
            });
        });

        document.querySelector('.item-card__cta-button')?.addEventListener('click', () => {
            const productId = document.querySelector('.item-card__badge')?.textContent || '';
            EventBus.sendToNative({
                type: 'buyNowButtonClicked',
                data: { productId }
            });
        });

        document.querySelector('.explore-button')?.addEventListener('click', () => {
            EventBus.sendToNative({
                type: 'exploreButtonClicked',
                data: {}
            });
        });

        document.querySelector('.reward-badge')?.addEventListener('click', () => {
            const points = document.querySelector('.reward-badge__points')?.textContent || '';
            EventBus.sendToNative({
                type: 'rewardBadgeClicked',
                data: { points }
            });
        });

        // Initially hide all components except explore button
        document.addEventListener('DOMContentLoaded', () => {
            ['brandFollowCard', 'itemCard', 'rewardBadge'].forEach(component => {
                const element = EventBus.getComponentElement(component);
                if (element) element.style.display = 'none';
            });

            // Notify native that WebView is ready
            EventBus.sendToNative({
                type: 'webViewReady',
                data: {}
            });
        });

        // Debug functions
        function debugShowBrandCard() {
            EventBus.showComponent({
                component: 'brandFollowCard',
                duration: 10000,
                data: {
                    brandName: 'Adidas',
                    followers: '+12 mil seguidores',
                    isVerified: true
                }
            });
        }

        function debugHideBrandCard() {
            EventBus.hideComponent('brandFollowCard');
        }

        function debugShowItemCard() {
            EventBus.showComponent({
                component: 'itemCard',
                duration: 10000,
                data: {
                    badge: '3',
                    originalPrice: '$ 111.000',
                    currentPrice: '$ 880.000',
                    discount: '10% OFF',
                    ctaText: 'Comprar ahora'
                }
            });
        }

        function debugHideItemCard() {
            EventBus.hideComponent('itemCard');
        }

        function debugShowReward() {
            EventBus.showComponent({
                component: 'rewardBadge',
                duration: 10000,
                data: {
                    points: '+ 20'
                }
            });
        }

        function debugHideReward() {
            EventBus.hideComponent('rewardBadge');
        }

        function debugUpdateBrand() {
            EventBus.updateComponentData('brandFollowCard', {
                brandName: 'Nike',
                followers: '+25 mil seguidores',
                isVerified: true
            });
        }

        function debugUpdateItem() {
            EventBus.updateComponentData('itemCard', {
                originalPrice: '$ 200.000',
                currentPrice: '$ 99.000',
                discount: '50% OFF',
                ctaText: '¬°Aprovecha!'
            });
        }

        function debugUpdateReward() {
            EventBus.updateComponentData('rewardBadge', {
                points: '+ 50'
            });
        }

        function debugTogglePanel() {
            const panel = document.querySelector('.debug-panel');
            if (panel) {
                panel.style.display = panel.style.display === 'none' ? 'flex' : 'none';
            }
        }
    </script>
</body>
</html>
